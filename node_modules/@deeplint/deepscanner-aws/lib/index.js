"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.scan = void 0;
const _ = require("lodash");
const aws_1 = require("./aws");
const ResourceMap = _.merge(aws_1.AWSResourceMap);
function scan(context) {
    return __awaiter(this, void 0, void 0, function* () {
        let res = [];
        yield Promise.all(Object.keys(ResourceMap).map((key) => __awaiter(this, void 0, void 0, function* () {
            const temp = yield ResourceMap[key].collect(context);
            res = res.concat(temp);
        })));
        return res;
    });
}
exports.scan = scan;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQUEsNEJBQTZCO0FBQzdCLCtCQUF1QztBQUd2QyxNQUFNLFdBQVcsR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLG9CQUFjLENBQUMsQ0FBQztBQUM1QyxTQUFzQixJQUFJLENBQUMsT0FBK0I7O1FBQ3hELElBQUksR0FBRyxHQUFlLEVBQUUsQ0FBQztRQUN6QixNQUFNLE9BQU8sQ0FBQyxHQUFHLENBQ2YsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBTyxHQUFHLEVBQUUsRUFBRTtZQUN6QyxNQUFNLElBQUksR0FBRyxNQUFNLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDckQsR0FBRyxHQUFHLEdBQUcsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDekIsQ0FBQyxDQUFBLENBQUMsQ0FDSCxDQUFDO1FBQ0YsT0FBTyxHQUFHLENBQUM7SUFDYixDQUFDO0NBQUE7QUFURCxvQkFTQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfID0gcmVxdWlyZSgnbG9kYXNoJyk7XG5pbXBvcnQgeyBBV1NSZXNvdXJjZU1hcCB9IGZyb20gJy4vYXdzJztcbmltcG9ydCB7IFJlc291cmNlIH0gZnJvbSAnQGRlZXBsaW50L2RlZXBzY2FubmVyLWJhc2UnO1xuXG5jb25zdCBSZXNvdXJjZU1hcCA9IF8ubWVyZ2UoQVdTUmVzb3VyY2VNYXApO1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNjYW4oY29udGV4dDogeyBba2V5OiBzdHJpbmddOiBhbnkgfSk6IFByb21pc2U8UmVzb3VyY2VbXT4ge1xuICBsZXQgcmVzOiBSZXNvdXJjZVtdID0gW107XG4gIGF3YWl0IFByb21pc2UuYWxsKFxuICAgIE9iamVjdC5rZXlzKFJlc291cmNlTWFwKS5tYXAoYXN5bmMgKGtleSkgPT4ge1xuICAgICAgY29uc3QgdGVtcCA9IGF3YWl0IFJlc291cmNlTWFwW2tleV0uY29sbGVjdChjb250ZXh0KTtcbiAgICAgIHJlcyA9IHJlcy5jb25jYXQodGVtcCk7XG4gICAgfSksXG4gICk7XG4gIHJldHVybiByZXM7XG59XG4iXX0=